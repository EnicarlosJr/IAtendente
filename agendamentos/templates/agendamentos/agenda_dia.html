{% extends "painel/base.html" %}
{% block title %}Agenda ‚Äî Dia{% endblock %}
{% block header %}Agenda{% endblock %}

{% block content %}
{% include "agendamentos/_agenda_tabs.html" %}

<div class="card overflow-hidden">

  <!-- Cabe√ßalho -->
  <div class="flex items-center justify-between px-5 sm:px-6 py-4 border-b border-slate-200 bg-slate-50/70 backdrop-blur">
    <h2 class="text-lg font-semibold text-slate-900 flex items-center gap-2">
      <span class="inline-flex items-center justify-center w-9 h-9 rounded-xl bg-blue-100 text-blue-600">üìÖ</span>
      Dia {{ date|date:"d/m/Y" }}
    </h2>
    <div class="flex gap-2">
      <a class="btn btn-secondary"
         href="{% url 'agendamentos:agenda_dia' shop.slug %}?dia={{ prev_day|date:'Y-m-d' }}">‚Üê Anterior</a>
      <a class="btn btn-secondary"
         href="{% url 'agendamentos:agenda_dia' shop.slug %}?dia={{ next_day|date:'Y-m-d' }}">Pr√≥ximo ‚Üí</a>
    </div>
  </div>

  {% if rows|length == 0 %}
    <div class="p-6 text-sm ia-text-muted">Sem hor√°rios configurados para este dia.</div>
  {% else %}

  <!-- GRID DE PER√çODOS -->
  <div class="grid grid-cols-1 md:grid-cols-3 divide-y md:divide-y-0 md:divide-x divide-slate-200">

    {# ================== MANH√É ================== #}
    <section class="p-5 sm:p-6">
      <h3 class="text-base font-semibold text-slate-800 mb-4 flex items-center gap-2">üåÖ Manh√£</h3>
      <div class="relative">
        <div class="absolute left-5 top-0 bottom-0 w-0.5 bg-slate-200"></div>
        <div class="space-y-6">
          {% with had_any=false %}
            {% for row in rows %}
              {% if row.time|date:"H" < '12' %}
                {% with had_any=true %}
                  <div class="relative pl-14">
                    {% include "agendamentos/_agenda_card.html" with row=row shop=shop %}
                  </div>
                {% endwith %}
              {% endif %}
            {% endfor %}
            {% if not had_any %}
              <p class="text-sm ia-text-muted">Nenhum hor√°rio neste per√≠odo.</p>
            {% endif %}
          {% endwith %}
        </div>
      </div>
    </section>

    {# ================== TARDE ================== #}
    <section class="p-5 sm:p-6">
      <h3 class="text-base font-semibold text-slate-800 mb-4 flex items-center gap-2">üåá Tarde</h3>
      <div class="relative">
        <div class="absolute left-5 top-0 bottom-0 w-0.5 bg-slate-200"></div>
        <div class="space-y-6">
          {% with had_any=false %}
            {% for row in rows %}
              {% if row.time|date:"H" >= '12' and row.time|date:"H" < '18' %}
                {% with had_any=true %}
                  <div class="relative pl-14">
                    {% include "agendamentos/_agenda_card.html" with row=row shop=shop %}
                  </div>
                {% endwith %}
              {% endif %}
            {% endfor %}
            {% if not had_any %}
              <p class="text-sm ia-text-muted">Nenhum hor√°rio neste per√≠odo.</p>
            {% endif %}
          {% endwith %}
        </div>
      </div>
    </section>

    {# ================== NOITE ================== #}
    <section class="p-5 sm:p-6">
      <h3 class="text-base font-semibold text-slate-800 mb-4 flex items-center gap-2">üåô Noite</h3>
      <div class="relative">
        <div class="absolute left-5 top-0 bottom-0 w-0.5 bg-slate-200"></div>
        <div class="space-y-6">
          {% with had_any=false %}
            {% for row in rows %}
              {% if row.time|date:"H" >= '18' %}
                {% with had_any=true %}
                  <div class="relative pl-14">
                    {% include "agendamentos/_agenda_card.html" with row=row shop=shop %}
                  </div>
                {% endwith %}
              {% endif %}
            {% endfor %}
            {% if not had_any %}
              <p class="text-sm ia-text-muted">Nenhum hor√°rio neste per√≠odo.</p>
            {% endif %}
          {% endwith %}
        </div>
      </div>
    </section>

  </div>
  {% endif %}
</div>
{% endblock %}

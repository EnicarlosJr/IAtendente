{# templates/solicitacoes/partials/acoes.html #}
<div class="flex justify-end gap-2">

  <a href="{% url 'solicitacoes:detalhe' shop.slug s.id %}" class="btn btn-secondary">
    üëÅÔ∏è Ver
  </a>

  {# ==== A√ß√µes para PENDENTE ==== #}
  {% if s.status == "PENDENTE" %}
    <form method="post"
          action="{% url 'solicitacoes:confirmar' shop.slug s.id %}"
          class="hidden"
          id="confirm-form-{{ s.id }}">
      {% csrf_token %}
      <input type="hidden" name="inicio" value="{% if s.inicio %}{{ s.inicio|date:'Y-m-d\\TH:i' }}{% endif %}">
      <input type="hidden" name="servico_id" value="{{ s.servico_id|default_if_none:'' }}">
      <input type="hidden" name="preco_cotado"
             value="{{ s.preco_cotado|default_if_none:s.servico.preco|default_if_none:'' }}">
    </form>

    <button type="button"
            class="btn btn-primary"
            onclick="document.getElementById('confirm-form-{{ s.id }}').submit()">
      ‚úÖ Confirmar
    </button>

    <form method="post"
          action="{% url 'solicitacoes:recusar' shop.slug s.id %}"
          class="hidden"
          id="deny-form-{{ s.id }}">
      {% csrf_token %}
      <input type="hidden" name="status" value="NEGADA">
      <input type="hidden" name="motivo" value="">
    </form>

    <button type="button"
            class="btn btn-danger"
            onclick="if(confirm('Negar esta solicita√ß√£o?')){ document.getElementById('deny-form-{{ s.id }}').submit(); }">
      ‚ùå Negar
    </button>

  {# ==== A√ß√µes para CONFIRMADA ==== #}
  {% elif s.status == "CONFIRMADA" %}
    {# Evite depender de agendamento_set. Se voc√™ mant√©m o v√≠nculo, use o related_name correto:
       {% with ag=s.agendamentos.all|slice:":1"|first %} ‚Ä¶ {% endwith %}
       Como na sua confirma√ß√£o voc√™ DESVINCULA o agendamento e depois DELETA a solicita√ß√£o,
       normalmente essa branch nem ser√° exibida.
    #}
    <span class="pill bg-emerald-100 text-emerald-700">Confirmada</span>

  {# ==== NEGADA ==== #}
  {% elif s.status == "NEGADA" %}
    <span class="text-sm text-gray-500 italic">Negada</span>

  {# ==== FINALIZADA / NO_SHOW ==== #}
  {% elif s.status == "FINALIZADA" or s.status == "NO_SHOW" %}
    {# Somente visualizar nessas situa√ß√µes #}
  {% endif %}
</div>
